<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at Mar 7, 2013
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Steven Swor" />
    <meta name="Date-Creation-yyyymmdd" content="20121221" />
    <meta name="Date-Revision-yyyymmdd" content="20130307" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Ehcache File Monitor - Performance Tuning</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.0.min.js"></script>

    
            </head>
        <body class="topBarEnabled">
          
                        
                    
                

    <div id="topbar" class="navbar navbar-fixed-top ">
      <div class="navbar-inner">
                                  <div class="container"><div class="nav-collapse">
            
                
                                <ul class="nav">
                          <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Overview <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li>      <a href="index.html"  title="About">About</a>
</li>
                  
                      <li>      <a href="resource-caching.html"  title="Resource Caching Tutorial">Resource Caching Tutorial</a>
</li>
                  
                      <li>      <a href="performance-tuning.html"  title="Performance Tuning">Performance Tuning</a>
</li>
                          </ul>
      </li>
                <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Project Documentation <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li class="dropdown-submenu">
                                      <a href="project-info.html"  title="Project Information">Project Information</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="project-summary.html"  title="Project Summary">Project Summary</a>
</li>
                                  <li>      <a href="dependency-info.html"  title="Dependency Information">Dependency Information</a>
</li>
                                  <li>      <a href="dependencies.html"  title="Dependencies">Dependencies</a>
</li>
                                  <li>      <a href="issue-tracking.html"  title="Issue Tracking">Issue Tracking</a>
</li>
                                  <li>      <a href="source-repository.html"  title="Source Repository">Source Repository</a>
</li>
                                  <li>      <a href="team-list.html"  title="Project Team">Project Team</a>
</li>
                                  <li>      <a href="distribution-management.html"  title="Distribution Management">Distribution Management</a>
</li>
                                  <li>      <a href="plugins.html"  title="Project Plugins">Project Plugins</a>
</li>
                                  <li>      <a href="license.html"  title="Project License">Project License</a>
</li>
                              </ul>
            </li>
                  
                      <li class="dropdown-submenu">
                                      <a href="project-reports.html"  title="Project Reports">Project Reports</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="apidocs/index.html"  title="JavaDocs">JavaDocs</a>
</li>
                                  <li>      <a href="testapidocs/index.html"  title="Test JavaDocs">Test JavaDocs</a>
</li>
                                  <li>      <a href="xref/index.html"  title="Source Xref">Source Xref</a>
</li>
                                  <li>      <a href="xref-test/index.html"  title="Test Source Xref">Test Source Xref</a>
</li>
                                  <li>      <a href="pmd.html"  title="PMD Report">PMD Report</a>
</li>
                                  <li>      <a href="cpd.html"  title="CPD Report">CPD Report</a>
</li>
                                  <li>      <a href="findbugs.html"  title="FindBugs Report">FindBugs Report</a>
</li>
                                  <li>      <a href="cobertura/index.html"  title="Cobertura Test Coverage">Cobertura Test Coverage</a>
</li>
                              </ul>
            </li>
                          </ul>
      </li>
                  </ul>
          
          
                                                              
                               <ul class="nav pull-right">
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">External Links <b class="caret"></b></a>
                <ul class="dropdown-menu">
                      <li>      <a href="http://www.ehcache.org/"  target="_blank" title="Ehcache">Ehcache</a>
</li>
      <li>      <a href="../sfmf4j/"  target="_blank" title="SFMF4J">SFMF4J</a>
</li>
                  </ul>
              </li>
            </ul>
          
                      </div>
          
        </div>
      </div>
    </div>
    
        <div class="container">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>Ehcache File Monitor</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                              <li class="">
                    <a href="index.html" title="Ehcache File Monitor">
        Ehcache File Monitor</a>
        </li>
      <li class="divider ">/</li>
        <li class="">Performance Tuning</li>
        
                
                    
                 <li id="projectVersion" class="pull-right">Version: 1.0-SNAPSHOT</li>
      
                            </ul>
      </div>

      
                
        <div id="bodyColumn" >
                                  
            <!--  --><!-- Copyright 2013 Steven Swor. --><!--  --><!-- Licensed under the Apache License, Version 2.0 (the "License"); --><!-- you may not use this file except in compliance with the License. --><!-- You may obtain a copy of the License at --><!--  --><!-- http://www.apache.org/licenses/LICENSE-2.0 --><!--  --><!-- Unless required by applicable law or agreed to in writing, software --><!-- distributed under the License is distributed on an "AS IS" BASIS, --><!-- WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. --><!-- See the License for the specific language governing permissions and --><!-- limitations under the License. --><!--  --><div class="section"><h2>Performance Tuning<a name="Performance_Tuning"></a></h2><p>This solution attempts to find a happy medium between memory consumption, logic freshness, application responsiveness, and file system I/O. However, performance will largely depend on how the application is used, and the settings might need to be adjusted to ensure optimum performance.</p><div class="section"><h3>Tuning Memory Usage<a name="Tuning_Memory_Usage"></a></h3><p>There are a lot of ways to configure memory management in Ehcache. So many, in fact, that it's probably better just to look at <a class="externalLink" href="http://ehcache.org/documentation/configuration/cache-size"> Ehcache's documentation on cache sizing</a> than mention them here.</p><p>It's important to choose the right settings for cache memory usage. If the cache is too small, then items will be evicted often, which can negatively affect performance by increasing disk I/O as items must be loaded from the file system more frequently (calls to <tt>SelfPopulatingCache.get()</tt> will block while the item is being loaded from the file system). If the cache is too large, then there will be less heap space available to the rest of the application, and performance could be negatively affected due to more frequent/thorough garbage collection (or worse, your application could start throwing <tt>OutOfMemoryError</tt>s).</p></div><div class="section"><h3>Tuning I/O<a name="Tuning_IO"></a></h3><p>Nearly every file system monitoring solution for Java (including NIO2) uses file system polling under certain circumstances (some poll all the time). Periodically polling the file system introduces some amount of disk I/O at regular intervals. Our solution attempts to minimize the impact by only monitoring directories containing files for which we have valid cache entries. I/O performance can be tuned by using a non-polling implementation of SFMF4J (such as the jpathwatch or NIO2 implementations), changing the polling interval for the cache expiration monitor (or the file system monitor), and carefully choosing where on the file system to place scripts.</p><p>Suggestions for tuning I/O:</p><ul><li>When using a polling implementation of SFMF4J, choose a file system polling interval based on how &quot;fresh&quot; you want the logic to be.<p>A short polling interval introduces unnecessary I/O, especially when the files don't change very often. Too long a polling interval, and your users might be using stale logic, or they might have to wait a while after a resource is updated before using a particular feature.</p></li><li>Choose a cache expiration timeout (<tt>timeToIdleSeconds</tt>) based on user demand for cached logic.<p>Too short a timeout, and you will see a performance impact on frequently-accessed application functions, since the application must constantly wait for the logic to be loaded from the file system. A long timeout can increase the amount of unnecessary I/O due to file system polling for resources which are no longer being used by the application.</p></li><li>Choose a cache expiration polling interval based on what you consider to be an acceptable amount of unnecessary file system polling.<p>A longer polling interval increases the amount of unnecessary I/O for resources which are used infrequently, as they are more likely to expire. A shorter polling interval can increase the amount of time it takes to retrieve a valid entry from the cache due to shared resource contention (Ehcache tries to minimize this as much as it can, but the impact is still there, however small it might be).</p></li><li>Consider the deployment environment when deciding where to place resource files.<p>Locally-attached storage tends to have better read performance than network-attached storage, and many of the non-polling file system monitoring implementations (such as <tt>inotify</tt>, <tt>kqueue</tt>, and <tt>ReadDirectoryChangesW</tt>) tend to be <i>less</i> reliable than their polling counterparts when monitoring network shares. Some file systems can be very slow to list a directory's contents if there are lots of files in the directory (this is noticeably slow in SMB shares with several thousand files in them - not uncommon in enterprise environments).</p><p>Should every resource be placed in the same directory, or would you see a performance boost by splitting them up into different directories? If so, how should they be split up to maximize I/O performance? These questions can only be correctly answered by evaluating how the application is deployed and how it is being used; they do not have one-size-fits-all answers.</p></li></ul></div></div>
                  </div>
          </div>

    <hr/>

    <footer>
            <div class="container">
              <div class="row span12">Copyright &copy;                    2013
                        <a href="https://github.com/sworisbreathing/">Steven Swor</a>.
            All Rights Reserved.      
                    
                  <li id="publishDate" class="pull-right">Last Published: 2013-03-07</li> 
            </div>

        
                <p id="poweredBy" class="pull-right">
                          <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
              </p>
        
                </div>
    </footer>
  </body>
</html>
